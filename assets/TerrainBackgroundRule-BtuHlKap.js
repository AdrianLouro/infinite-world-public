import{d as H,o as d,c as u,l as a,g as y,v as K,m as P,p as E,q as w,_ as I,e as F,s as G,t as L,u as J,x as Q,y as X,z as U,i as h,F as B,A as O,B as m,C as S,D,E as N,a as Y,G as Z,H as ee,W as te,h as oe,I as ne}from"./index-BKOiDF9a.js";const M=(n,t,e)=>n.toSorted((o,c)=>e(o).localeCompare(e(c))).reduce((o,c)=>({...o,[t(c)]:e(c)}),{});var se=(n=>(n.Hexagon="hexagon",n.Square="square",n))(se||{});const ae=H({__name:"LandNotesBubble",props:{land:{type:Object,required:!0},direction:{type:String,required:!0}},emits:["hide"],setup(n,{emit:t}){const e=n,k=t,o=()=>{k("hide")};return(c,r)=>(d(),u("div",{class:w(["land-notes-bubble",{[`land-notes-bubble--direction-${e.direction}`]:e.direction}])},[a("div",{class:"hide-button",onClick:r[0]||(r[0]=b=>o())},"âœ•"),y(a("textarea",{"onUpdate:modelValue":r[1]||(r[1]=b=>e.land.notes=b),onKeyup:r[2]||(r[2]=P(b=>o(),["esc"])),onWheel:r[3]||(r[3]=E(()=>{},["stop"]))},null,544),[[K,e.land.notes]])],2))}}),re=I(ae,[["__scopeId","data-v-93fbccdf"]]);var x=(n=>(n.Top="top",n.Bottom="bottom",n))(x||{});const le={class:"land__content"},de={class:"info"},ie={value:null},ue=["value"],ce={value:null},pe=["value"],be={value:null},ge=["value"],ve={class:"bottom-actions"},ke=H({__name:"Land",props:{terrainsBackgroundRules:{type:Array,required:!0},terrainsOptions:{type:Object,required:!0},land:{type:Object,required:!0},shape:{type:String,required:!0},showLocations:{type:Boolean,required:!0},showDungeons:{type:Boolean,required:!0},showRotateButton:{type:Boolean,required:!0},showNotesButton:{type:Boolean,required:!0},notesBubbleDirection:{type:String,required:!0}},emits:["dblclick","rotateTerrainClick"],setup(n,{emit:t}){const e=n,k=F(),o=t,c=G(!1),r=L(()=>e.terrainsBackgroundRules.find(s=>s.appliesFor(e.land))),b=L(()=>{var s;return((s=r.value)==null?void 0:s.backgroundType)==="color"}),f=L(()=>{var s;return((s=r.value)==null?void 0:s.backgroundType)==="image"}),{t:R}=J({useScope:"global"}),_=()=>{o("dblclick")},g=()=>{o("rotateTerrainClick")},p=()=>{c.value=!c.value},v=()=>{c.value=!1},T=M(Q,s=>s,s=>R(`location.${s}`)),$=M(X,s=>s,s=>R(`dungeon.${s}`));return(s,l)=>{var W,z,A,V,j;return d(),u("div",{class:w(["land",{"land--current":e.land.isCurrent,[`land--${e.land.terrain}`]:e.land.terrain,[`land--${e.shape}`]:e.shape,[`land--background-type-${(W=r.value)==null?void 0:W.backgroundType}`]:(z=r.value)==null?void 0:z.backgroundType}]),style:U({backgroundColor:b.value?(A=r.value)==null?void 0:A.background:"transparent ",borderColor:b.value?(V=r.value)==null?void 0:V.background:"transparent"})},[a("div",le,[a("div",{class:w(["terrain-image",{[`terrain-image--rotation-${e.land.terrainRotation}`]:e.land.terrainRotation}]),style:U({backgroundImage:f.value?`url(${(j=r.value)==null?void 0:j.background})`:"transparent"})},null,6),a("div",de,[h(k).showHud?(d(),u(B,{key:0},[y(a("select",{"onUpdate:modelValue":l[0]||(l[0]=i=>e.land.terrain=i)},[a("option",ie,m(`<${s.$t("label.terrain")}>`),1),(d(!0),u(B,null,S(e.terrainsOptions,(i,C,q)=>(d(),u("option",{key:q,value:C},m(i),9,ue))),128))],512),[[O,e.land.terrain]]),e.showLocations?y((d(),u("select",{key:0,"onUpdate:modelValue":l[1]||(l[1]=i=>e.land.location=i)},[a("option",ce,m(`<${s.$t("label.location")}>`),1),(d(!0),u(B,null,S(h(T),(i,C,q)=>(d(),u("option",{key:q,value:C},m(i),9,pe))),128))],512)),[[O,e.land.location]]):D("",!0),e.showDungeons?y((d(),u("select",{key:1,"onUpdate:modelValue":l[2]||(l[2]=i=>e.land.dungeon=i)},[a("option",be,m(`<${s.$t("label.dungeon")}>`),1),(d(!0),u(B,null,S(h($),(i,C,q)=>(d(),u("option",{key:q,value:C},m(i),9,ge))),128))],512)),[[O,e.land.dungeon]]):D("",!0)],64)):D("",!0)]),a("div",ve,[y(a("div",{class:"rotate-button",onClick:l[3]||(l[3]=i=>g())},null,512),[[N,h(k).showHud&&e.showRotateButton]]),a("div",{class:"coordinates",onDblclick:l[4]||(l[4]=i=>_())},m(e.land.coordinates.x+" / "+e.land.coordinates.y),33),y(a("div",{class:w(["notes-button",{"notes-button--empty":!e.land.notes}]),onClick:l[5]||(l[5]=i=>p())},null,2),[[N,h(k).showHud&&e.showNotesButton]]),y(Y(re,{land:e.land,direction:e.notesBubbleDirection,onHide:l[6]||(l[6]=i=>v()),onClick:l[7]||(l[7]=E(()=>{},["stop"]))},null,8,["land","direction"]),[[N,c.value]])])])],6)}}}),me=I(ke,[["__scopeId","data-v-acbcbeee"]]),ye={class:"top"},he={class:"center"},we={class:"lands"},Be={class:"bottom"},$e=H({__name:"World",props:{terrainsOptions:{type:Object,required:!0},terrainsBackgroundRules:{type:Array,required:!0},landShape:{type:String,required:!0},showLocations:{type:Boolean,required:!0},showDungeons:{type:Boolean,required:!0},showRotateButton:{type:Boolean,required:!0},showNotesButton:{type:Boolean,required:!0},initialSize:{type:Number,required:!0}},setup(n){const t=n,e=ne(),o=Z(e.get()??te.ofSize(t.initialSize));ee(o,g=>{e.save(g)});const c=()=>{o.addTopRow()},r=()=>{o.addBottomRow()},b=()=>{o.addLeftColumn()},f=()=>{o.addRightColumn()},R=g=>{o.movePlayersTo(g)},_=g=>{o.rotateTerrainAt(g)};return(g,p)=>(d(),u("div",{class:w(["world",{[`world--${t.landShape}`]:t.landShape}])},[a("div",ye,[a("div",{class:"add-button",onClick:p[0]||(p[0]=v=>c())},"+")]),a("div",he,[a("div",{class:w(["add-button",{"add-button--margin-right-square":t.landShape==="square"&&o.lands.length>1,"add-button--margin-right-hexagon":t.landShape==="hexagon"&&o.lands.length>1}]),onClick:p[1]||(p[1]=v=>b())}," + ",2),a("div",we,[(d(!0),u(B,null,S(o.lands,(v,T)=>(d(),u("div",{key:T,class:w(["row",{"row--margin-left-square":t.landShape==="square"&&o.lands.length>1,"row--margin-left-hexagon":t.landShape==="hexagon"&&v[0].coordinates.y%2!==0}])},[(d(!0),u(B,null,S(v,($,s)=>(d(),oe(me,{key:s,land:$,"terrains-options":n.terrainsOptions,"terrains-background-rules":n.terrainsBackgroundRules,shape:t.landShape,"show-locations":t.showLocations,"show-dungeons":t.showDungeons,"show-rotate-button":t.showRotateButton,"show-notes-button":t.showNotesButton,"notes-bubble-direction":T===0&&o.lands.length>1?h(x).Bottom:h(x).Top,onDblclick:l=>R($.coordinates),onRotateTerrainClick:l=>_($.coordinates)},null,8,["land","terrains-options","terrains-background-rules","shape","show-locations","show-dungeons","show-rotate-button","show-notes-button","notes-bubble-direction","onDblclick","onRotateTerrainClick"]))),128))],2))),128))]),a("div",{class:"add-button",onClick:p[2]||(p[2]=v=>f())},"+")]),a("div",Be,[a("div",{class:"add-button",onClick:p[3]||(p[3]=v=>r())},"+")])],2))}}),qe=I($e,[["__scopeId","data-v-49bbb372"]]),Se=(n,t)=>({appliesFor:n,background:t,backgroundType:"color"}),Re=(n,t)=>({appliesFor:n,background:t,backgroundType:"image"});export{se as L,qe as W,Se as a,Re as b,M as c};
